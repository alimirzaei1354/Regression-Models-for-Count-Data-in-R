# data set 
MF_read_CsV<-function(path,use_UTF8=TRUE,choose_file=FALSE,set_max_overlaps=TRUE){
  if(set_max_overlaps){
    options(ggrepel.max.overlaps = Inf)
  }
  if(choose_file){
    path=file.choose()
  }
  if(use_UTF8){
    data<- read.csv(path,encoding="UTF-8")
  }else{
    data<- read.csv(path)
  }
  
  return(data)
}

df.esf.hour<- MF_read_CsV(path="C:/Users/Traffic/Desktop/SOHBATZADEH/esf_hour98.csv")
str(df.esf.hour)
hist(df.esf.hour$acc_total)
par(mfrow=c(1,1))
plot(table(df.esf.hour$acc_total))
mod.glm <- glm(acc_total ~ 1 +(TOTAL_VEHICLES|JMONTH)+offset(log(SPEED_VIOLATIONS)), data=df.esf.hour,family=poisson)
root.poisson <- countreg::rootogram(glm(acc_total ~ 1 +(TOTAL_VEHICLES|JMONTH)+offset(log(SPEED_VIOLATIONS)), data=df.esf.hour,family=poisson),style = "standing", plot = TRUE)
par(mar=c(1,1,1,1)) 
par(mfrow=c(1,1))
plot(root.poisson)
#model 
mod.hurdle.Poisson <- hurdle(acc_total ~ 1 +(TOTAL_VEHICLES|IS_HOLIDAY)+offset(log(SPEED_VIOLATIONS)), data=df.esf.hour,dist ="poisson", zero.dist="binomial")
mod.hurdle.nb <- hurdle(acc_total ~ 1 +(TOTAL_VEHICLES|IS_HOLIDAY)+offset(log(SPEED_VIOLATIONS)), data=df.esf.hour,dist ="negbin", zero.dist="binomial")
AIC(mod.hurdle.Poisson,mod.hurdle.nb)
